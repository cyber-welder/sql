USE lesson7;

DROP TABLE IF EXISTS catalogs;
CREATE TABLE catalogs (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) COMMENT 'Название раздела',
  UNIQUE unique_name(name(10))
) COMMENT = 'Разделы интернет-магазина';

INSERT INTO catalogs VALUES
  (NULL, 'Процессоры'),
  (NULL, 'Материнские платы'),
  (NULL, 'Видеокарты'),
  (NULL, 'Жесткие диски'),
  (NULL, 'Оперативная память');

DROP TABLE IF EXISTS rubrics;
CREATE TABLE rubrics (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) COMMENT 'Название раздела'
) COMMENT = 'Разделы интернет-магазина';

INSERT INTO rubrics VALUES
  (NULL, 'Видеокарты'),
  (NULL, 'Память');

DROP TABLE IF EXISTS users;
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) COMMENT 'Имя покупателя',
  birthday_at DATE COMMENT 'Дата рождения',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT = 'Покупатели';

INSERT INTO users (name, birthday_at) VALUES
  ('Геннадий', '1990-10-05'),
  ('Наталья', '1984-11-12'),
  ('Александр', '1985-05-20'),
  ('Сергей', '1988-02-14'),
  ('Иван', '1998-01-12'),
  ('Мария', '1992-08-29');

DROP TABLE IF EXISTS products;
CREATE TABLE products (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) COMMENT 'Название',
  description TEXT COMMENT 'Описание',
  price DECIMAL (11,2) COMMENT 'Цена',
  catalog_id INT UNSIGNED,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY index_of_catalog_id (catalog_id)
) COMMENT = 'Товарные позиции';

INSERT INTO products
  (name, description, price, catalog_id)
VALUES
  ('Intel Core i3-8100', 'Процессор для настольных персональных компьютеров, основанных на платформе Intel.', 7890.00, 1),
  ('Intel Core i5-7400', 'Процессор для настольных персональных компьютеров, основанных на платформе Intel.', 12700.00, 1),
  ('AMD FX-8320E', 'Процессор для настольных персональных компьютеров, основанных на платформе AMD.', 4780.00, 1),
  ('AMD FX-8320', 'Процессор для настольных персональных компьютеров, основанных на платформе AMD.', 7120.00, 1),
  ('ASUS ROG MAXIMUS X HERO', 'Материнская плата ASUS ROG MAXIMUS X HERO, Z370, Socket 1151-V2, DDR4, ATX', 19310.00, 2),
  ('Gigabyte H310M S2H', 'Материнская плата Gigabyte H310M S2H, H310, Socket 1151-V2, DDR4, mATX', 4790.00, 2),
  ('MSI B250M GAMING PRO', 'Материнская плата MSI B250M GAMING PRO, B250, Socket 1151, DDR4, mATX', 5060.00, 2);

DROP TABLE IF EXISTS orders;
CREATE TABLE orders (
  id SERIAL PRIMARY KEY,
  user_id INT UNSIGNED,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY index_of_user_id(user_id)
) COMMENT = 'Заказы';

-- заполнил на filldb.info
INSERT INTO `orders` VALUES (1,6,'2016-09-27 17:20:58','2013-08-27 10:28:00'),(2,4,'2019-11-29 15:51:38','2017-07-10 16:44:51'),(3,4,'2020-08-15 11:14:22','2013-11-27 21:00:52'),(4,1,'2013-11-04 18:44:09','2018-06-20 03:13:53'),(5,1,'2012-09-06 17:37:37','2013-10-08 08:52:40'),(6,5,'2012-11-17 08:18:22','2012-06-03 12:09:41'),(7,3,'2017-09-19 09:13:45','2018-05-27 16:56:38'),(8,6,'2016-08-11 12:29:13','2014-03-08 20:02:14'),(9,5,'2016-01-13 10:45:45','2014-07-26 10:27:16'),(10,6,'2016-02-14 10:32:18','2011-12-20 13:29:21'),(11,4,'2018-05-23 21:05:38','2013-11-21 10:06:06'),(12,6,'2014-09-15 23:57:58','2017-03-14 08:09:37'),(13,6,'2017-02-05 21:43:34','2014-09-15 14:53:25'),(14,3,'2019-07-11 20:41:03','2018-09-04 06:06:46'),(15,1,'2013-04-19 09:36:53','2014-01-20 06:14:55'),(16,5,'2019-12-04 21:36:34','2011-10-04 04:19:29'),(17,3,'2013-06-15 10:27:55','2017-08-31 18:53:11'),(18,2,'2020-03-03 23:15:47','2012-02-07 04:43:57'),(19,1,'2018-06-30 04:33:24','2012-05-10 15:59:00'),(20,6,'2013-08-07 18:11:51','2011-05-07 05:05:15'),(21,5,'2018-10-09 18:01:14','2013-09-15 12:36:17'),(22,1,'2015-05-01 09:47:58','2016-07-19 02:27:37'),(23,6,'2013-07-04 23:11:47','2012-10-27 23:37:20'),(24,4,'2018-11-09 15:51:47','2019-09-11 02:44:06'),(25,5,'2015-05-10 17:40:01','2014-09-07 22:25:02'),(26,6,'2014-09-03 08:55:42','2012-12-14 15:43:58'),(27,3,'2012-07-28 22:39:55','2021-03-05 12:25:08'),(28,6,'2020-12-17 21:43:24','2019-08-31 07:49:02'),(29,5,'2016-10-22 01:54:02','2013-02-07 01:17:40'),(30,1,'2020-12-04 18:51:35','2019-05-25 10:59:52'),(31,6,'2016-11-21 10:12:33','2018-01-02 11:24:34'),(32,1,'2021-03-22 12:10:18','2020-05-01 16:51:52'),(33,1,'2013-12-12 22:29:53','2015-02-23 00:18:15'),(34,1,'2015-10-30 03:29:17','2013-02-21 13:43:23'),(35,5,'2015-08-20 21:00:29','2014-03-20 07:51:39'),(36,6,'2012-10-24 01:18:18','2014-01-30 10:58:48'),(37,3,'2017-09-17 10:22:08','2018-04-02 12:29:54'),(38,4,'2011-10-06 11:51:33','2020-05-30 03:12:00'),(39,3,'2015-05-13 21:40:55','2012-04-20 04:44:18'),(40,1,'2011-07-16 19:51:17','2013-06-21 01:53:31'),(41,2,'2016-12-29 15:20:13','2017-12-27 23:48:20'),(42,5,'2014-03-29 17:05:52','2015-06-29 19:44:09'),(43,4,'2013-02-06 08:37:11','2014-01-11 13:00:27'),(44,3,'2015-04-15 01:58:04','2013-02-25 02:57:13'),(45,3,'2020-07-10 13:02:29','2011-07-21 06:19:01'),(46,5,'2018-11-07 11:18:30','2019-11-21 00:44:41'),(47,1,'2011-08-14 18:33:13','2017-03-21 16:07:18'),(48,3,'2011-09-04 12:01:00','2011-07-22 01:55:02'),(49,5,'2015-07-08 09:25:05','2017-06-01 17:10:50'),(50,4,'2013-08-18 08:49:20','2012-09-28 15:10:34'),(51,1,'2020-06-11 16:02:03','2015-01-08 18:45:16'),(52,5,'2011-06-06 15:12:26','2012-07-12 07:58:46'),(53,2,'2012-08-12 13:20:10','2013-07-10 09:07:08'),(54,6,'2014-05-14 02:51:06','2013-02-12 17:31:57'),(55,2,'2013-05-10 02:25:14','2018-12-21 04:16:23'),(56,1,'2020-03-14 11:13:25','2012-03-11 07:12:12'),(57,4,'2011-07-27 18:25:19','2019-05-24 03:49:34'),(58,1,'2020-11-19 09:22:24','2017-07-02 19:53:45'),(59,6,'2011-05-25 05:04:19','2017-12-26 18:25:50'),(60,3,'2016-02-02 23:16:09','2020-01-25 11:32:38'),(61,1,'2019-12-07 15:08:22','2014-08-09 23:38:02'),(62,4,'2020-05-22 12:22:40','2014-12-10 16:00:49'),(63,3,'2013-07-08 02:44:09','2017-02-20 20:12:41'),(64,3,'2017-02-01 17:03:50','2014-01-10 03:02:04'),(65,4,'2012-11-07 22:53:01','2015-09-22 22:38:49'),(66,6,'2012-04-13 21:38:53','2012-07-03 12:38:17'),(67,4,'2018-04-15 15:05:54','2021-03-15 01:29:12'),(68,3,'2016-05-03 13:17:05','2016-03-09 05:27:50'),(69,6,'2017-09-06 18:58:58','2013-07-06 02:49:33'),(70,5,'2013-08-12 17:07:03','2012-07-02 09:33:31'),(71,1,'2013-02-27 10:20:51','2015-08-04 18:58:32'),(72,1,'2018-10-07 07:35:20','2015-12-28 04:06:22'),(73,4,'2015-04-25 18:55:53','2020-12-25 09:46:27'),(74,1,'2020-08-17 09:24:19','2013-01-01 17:08:59'),(75,2,'2021-01-13 08:07:44','2017-05-21 06:10:28'),(76,2,'2014-12-01 12:12:22','2013-07-15 21:23:25'),(77,4,'2017-08-03 10:28:42','2015-09-04 11:59:55'),(78,4,'2011-11-14 00:56:16','2011-06-04 09:42:19'),(79,5,'2020-05-17 20:23:11','2011-06-01 01:56:13'),(80,2,'2011-07-11 23:05:21','2012-04-09 10:57:20'),(81,4,'2018-05-02 22:24:53','2012-08-17 17:14:53'),(82,3,'2017-08-29 09:59:00','2018-03-31 21:28:40'),(83,3,'2017-11-09 04:55:21','2021-01-23 20:00:43'),(84,2,'2018-08-11 16:55:31','2019-11-09 09:34:57'),(85,5,'2014-05-13 11:20:33','2017-12-30 11:40:37'),(86,3,'2020-04-20 15:06:00','2020-10-10 14:11:31'),(87,3,'2011-10-19 15:27:25','2012-01-04 00:38:23'),(88,5,'2014-03-18 03:42:46','2019-12-28 19:02:25'),(89,1,'2016-09-30 13:30:30','2020-03-11 22:52:35'),(90,2,'2016-11-28 23:43:49','2013-08-11 15:35:13'),(91,1,'2019-01-08 17:34:28','2018-08-15 22:54:40'),(92,1,'2021-03-29 00:03:51','2012-10-09 13:39:23'),(93,5,'2014-03-04 07:17:03','2013-03-01 10:12:53'),(94,4,'2019-10-26 10:19:02','2017-09-19 00:50:28'),(95,4,'2012-10-13 05:52:45','2020-03-29 21:00:10'),(96,4,'2020-08-04 00:22:15','2011-05-07 03:31:54'),(97,5,'2012-09-09 18:13:30','2020-06-19 10:09:01'),(98,2,'2018-02-21 22:28:26','2019-11-23 03:36:27'),(99,2,'2017-12-25 07:30:57','2012-08-22 09:08:23'),(100,5,'2021-03-09 18:40:03','2017-01-12 12:31:24');

DROP TABLE IF EXISTS orders_products;
CREATE TABLE orders_products (
  id SERIAL PRIMARY KEY,
  order_id INT UNSIGNED,
  product_id INT UNSIGNED,
  total INT UNSIGNED DEFAULT 1 COMMENT 'Количество заказанных товарных позиций',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT = 'Состав заказа';

-- заполнил на filldb.info
INSERT INTO `orders_products` VALUES (1,7,4,10,'2018-09-06 13:42:47','2012-03-04 21:44:57'),(2,1,6,2,'2017-07-19 11:33:53','2012-12-08 11:15:05'),(3,3,6,3,'2016-11-24 03:39:35','2013-05-01 06:53:18'),(4,47,4,5,'2013-10-21 13:52:26','2014-11-24 00:08:04'),(5,80,5,10,'2011-10-30 16:09:10','2021-03-08 10:09:58'),(6,40,6,6,'2011-12-10 11:16:41','2013-12-29 01:46:22'),(7,24,7,7,'2013-09-03 11:55:38','2020-11-01 19:50:14'),(8,39,5,10,'2018-05-29 14:09:07','2011-08-24 18:17:11'),(9,4,4,9,'2019-12-02 18:29:49','2015-09-13 13:54:22'),(10,16,7,5,'2016-12-28 00:43:13','2018-01-17 06:43:20'),(11,28,4,8,'2020-12-10 05:33:15','2020-07-13 23:40:09'),(12,27,1,2,'2020-08-29 18:10:55','2018-01-24 12:22:20'),(13,69,7,9,'2017-12-12 01:17:17','2018-09-11 01:34:08'),(14,91,3,9,'2019-11-30 17:16:57','2019-02-13 08:05:53'),(15,89,1,9,'2019-06-17 16:10:39','2015-04-26 05:39:48'),(16,27,1,6,'2013-03-03 12:14:12','2019-08-06 13:03:52'),(17,64,2,9,'2011-05-19 01:29:56','2016-05-14 17:21:40'),(18,37,1,1,'2014-10-12 01:00:05','2012-10-21 02:51:54'),(19,77,3,9,'2017-04-12 15:45:35','2011-11-09 02:19:21'),(20,32,7,6,'2020-01-11 20:32:41','2011-08-20 19:48:49'),(21,67,7,6,'2017-06-10 06:39:12','2019-03-21 02:18:49'),(22,14,2,2,'2018-02-22 16:13:40','2016-07-19 02:53:31'),(23,76,4,5,'2011-10-14 11:23:34','2012-11-23 04:45:37'),(24,4,2,10,'2018-07-19 13:21:30','2021-01-14 06:50:24'),(25,76,4,6,'2013-03-23 20:25:15','2021-02-12 15:09:45'),(26,18,5,1,'2017-01-08 16:49:55','2013-12-04 21:51:09'),(27,15,5,5,'2015-04-20 15:47:26','2020-09-02 13:20:09'),(28,91,5,6,'2013-06-10 09:45:08','2016-12-17 06:02:49'),(29,50,5,8,'2016-06-07 06:42:32','2017-06-17 05:09:10'),(30,32,5,9,'2012-11-25 01:49:49','2017-01-04 16:49:32'),(31,65,4,2,'2017-08-26 19:03:13','2012-06-27 02:01:39'),(32,99,1,1,'2012-07-04 10:38:17','2014-11-11 12:21:49'),(33,74,6,4,'2015-12-18 22:28:07','2017-11-16 06:46:58'),(34,28,7,8,'2018-02-28 18:16:43','2014-02-15 20:11:09'),(35,39,5,4,'2018-12-05 04:34:53','2020-08-14 15:23:05'),(36,18,2,7,'2019-03-12 12:26:33','2012-02-03 21:21:36'),(37,36,5,4,'2014-04-26 13:01:22','2020-12-03 18:57:36'),(38,46,5,10,'2018-10-17 15:15:30','2020-04-25 06:00:55'),(39,50,7,4,'2012-11-07 13:14:42','2020-04-12 12:23:32'),(40,15,4,5,'2012-04-06 17:52:26','2014-04-24 02:02:16'),(41,91,5,5,'2014-12-13 13:44:26','2018-02-15 00:43:14'),(42,36,6,9,'2013-03-17 00:35:53','2016-12-18 00:49:18'),(43,10,6,8,'2017-05-05 01:07:47','2019-01-27 08:53:30'),(44,50,6,8,'2016-01-05 11:54:41','2019-06-11 15:06:11'),(45,23,1,8,'2015-07-10 05:42:53','2015-06-27 20:37:37'),(46,5,4,4,'2020-11-06 13:45:37','2014-08-27 11:58:49'),(47,50,6,5,'2017-10-15 21:18:52','2013-09-21 06:56:08'),(48,17,2,5,'2019-01-25 01:58:15','2011-10-02 10:46:23'),(49,12,6,5,'2020-10-30 17:50:01','2020-01-17 10:28:29'),(50,89,2,2,'2020-02-08 20:37:50','2017-05-10 09:31:57'),(51,92,3,6,'2018-04-21 08:10:11','2011-10-19 03:44:46'),(52,9,6,7,'2016-01-08 22:18:04','2011-07-23 08:06:37'),(53,72,7,1,'2020-05-20 22:33:55','2013-10-12 11:14:17'),(54,53,6,5,'2014-02-24 17:03:56','2013-03-12 01:44:01'),(55,5,1,7,'2020-11-25 17:47:38','2019-12-29 18:17:29'),(56,65,1,7,'2013-02-02 06:05:29','2012-02-17 18:32:57'),(57,36,3,5,'2016-03-28 02:26:52','2013-09-06 01:58:16'),(58,7,7,10,'2018-01-11 08:21:36','2011-07-10 11:13:50'),(59,52,3,7,'2020-12-13 06:08:53','2016-10-03 21:52:09'),(60,30,1,3,'2012-08-31 03:33:01','2011-07-30 18:36:21'),(61,70,1,6,'2016-05-16 01:24:15','2019-06-18 12:47:19'),(62,34,1,9,'2015-12-17 19:48:59','2018-04-11 06:23:16'),(63,85,1,3,'2012-11-22 11:39:06','2013-11-09 17:04:39'),(64,88,4,9,'2014-06-11 14:47:26','2014-01-07 04:34:06'),(65,92,1,9,'2012-10-14 02:46:42','2020-08-24 14:03:25'),(66,15,3,5,'2012-10-06 14:34:09','2014-10-13 18:02:40'),(67,35,6,1,'2019-05-29 01:41:04','2018-04-24 22:19:32'),(68,80,2,9,'2019-08-29 17:41:34','2021-03-18 01:29:32'),(69,76,7,7,'2021-01-26 15:34:45','2020-02-08 16:05:21'),(70,56,1,5,'2015-03-09 02:19:53','2018-07-19 05:36:19'),(71,2,2,3,'2015-04-14 06:44:02','2016-06-12 21:58:14'),(72,62,6,7,'2014-08-20 15:09:02','2017-03-09 01:31:33'),(73,70,2,6,'2012-04-18 06:01:30','2011-11-20 14:38:51'),(74,81,2,7,'2017-02-09 07:19:36','2017-08-09 15:56:38'),(75,98,6,1,'2013-01-02 15:23:03','2013-11-16 15:23:24'),(76,30,1,3,'2015-06-05 23:54:56','2018-08-16 21:54:35'),(77,21,7,4,'2017-07-13 13:22:16','2018-09-10 13:07:47'),(78,90,4,4,'2014-04-16 22:59:56','2019-09-10 06:49:25'),(79,25,6,10,'2018-06-06 09:06:19','2018-08-31 08:05:54'),(80,98,6,2,'2017-06-14 12:59:49','2014-08-01 19:28:13'),(81,74,7,7,'2014-02-22 07:01:28','2020-01-20 00:31:18'),(82,22,7,9,'2012-11-15 08:45:20','2016-03-28 11:00:24'),(83,35,6,4,'2014-02-17 08:19:24','2011-08-11 21:33:49'),(84,93,4,2,'2011-09-30 20:16:11','2014-05-28 03:10:43'),(85,74,4,8,'2014-05-02 03:27:56','2011-10-25 18:19:19'),(86,31,6,9,'2013-07-09 16:49:35','2015-08-17 17:08:05'),(87,59,4,5,'2017-03-31 20:27:38','2016-09-03 13:21:45'),(88,86,3,9,'2016-01-28 09:07:43','2017-02-22 10:45:58'),(89,47,1,3,'2019-09-30 10:00:51','2020-06-05 20:19:24'),(90,43,7,9,'2018-02-09 15:13:12','2018-09-22 21:26:20'),(91,26,7,6,'2019-05-24 23:57:19','2019-08-20 06:49:19'),(92,36,4,10,'2018-09-13 20:46:34','2013-01-12 20:23:24'),(93,74,2,6,'2018-10-22 13:24:48','2012-03-04 22:00:25'),(94,46,6,9,'2019-03-09 18:35:09','2013-01-06 14:42:33'),(95,36,2,7,'2018-09-20 12:53:08','2011-10-15 22:59:16'),(96,76,2,3,'2020-10-13 03:51:38','2017-10-14 16:24:36'),(97,51,4,9,'2018-09-21 04:30:49','2021-04-25 20:58:27'),(98,46,4,8,'2018-09-20 20:08:47','2016-08-30 17:40:31'),(99,97,7,7,'2017-08-04 21:58:43','2013-07-16 10:48:28'),(100,39,3,2,'2018-01-09 00:44:22','2020-04-30 14:31:06');

DROP TABLE IF EXISTS discounts;
CREATE TABLE discounts (
  id SERIAL PRIMARY KEY,
  user_id INT UNSIGNED,
  product_id INT UNSIGNED,
  discount FLOAT UNSIGNED COMMENT 'Величина скидки от 0.0 до 1.0',
  started_at DATETIME,
  finished_at DATETIME,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY index_of_user_id(user_id),
  KEY index_of_product_id(product_id)
) COMMENT = 'Скидки';

DROP TABLE IF EXISTS storehouses;
CREATE TABLE storehouses (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) COMMENT 'Название',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT = 'Склады';

DROP TABLE IF EXISTS storehouses_products;
CREATE TABLE storehouses_products (
  id SERIAL PRIMARY KEY,
  storehouse_id INT UNSIGNED,
  product_id INT UNSIGNED,
  value INT UNSIGNED COMMENT 'Запас товарной позиции на складе',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT = 'Запасы на складе';





-- Задание 7.1
-- Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине.
SELECT 
	u.name AS name,
	COUNT(*) AS count_orders
FROM orders AS o
JOIN users AS u
ON u.id = o.user_id 
GROUP BY name
ORDER BY count_orders;



-- Задание 7.2
-- Выведите список товаров products и разделов catalogs, который соответствует товару.
SELECT 
	p.name AS product, 
	c.name AS catalog
FROM products AS p
JOIN catalogs AS c
ON p.catalog_id = c.id;




-- Задание 7.3
-- (по желанию) Пусть имеется таблица рейсов flights (id, from, to) и таблица городов cities (label, name). 
-- Поля from, to и label содержат английские названия городов, поле name — русское. 
-- Выведите список рейсов flights с русскими названиями городов.

-- Создаем таблицы
DROP TABLE IF EXISTS flights;
CREATE TABLE flights (
  id SERIAL PRIMARY KEY,
  from_city VARCHAR(255) COMMENT 'Пункт вылета',
  to_city VARCHAR(255) COMMENT 'Пункт прилёта'
) COMMENT = 'Рейсы';

INSERT INTO flights
  (id, from_city, to_city)
VALUES
	(1,'moscow','omsk'),
	(2,'novgorod','kazan'),
	(3,'irkutsk','moscow'),
	(4,'omsk','irkutsk'),
	(5,'moscow','kazan');

DROP TABLE IF EXISTS cities;
CREATE TABLE cities (
  label VARCHAR(255) COMMENT 'Транскрипция',
  name VARCHAR(255) COMMENT 'Название города'
) COMMENT = 'Города';

INSERT INTO cities
  (label, name)
VALUES
	('moscow','Москва'),
	('irkutsk','Иркутск'),
	('novgorod','Новгород'),
	('kazan','Казань'),
	('omsk','Омск');
  

-- Ответ 7.3
SELECT 
	flights.id,
	(SELECT cities.name FROM cities WHERE cities.label = flights.from_city) AS from_city,
	(SELECT cities.name FROM cities WHERE cities.label = flights.to_city) AS to_city
FROM flights
JOIN cities
ON flights.from_city = cities.label
ORDER BY flights.id;















